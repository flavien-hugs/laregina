{% extends "base.html" %}
{% load static mptt_tags pages_tags catalogue_tags %}
{% get_static_prefix as STATIC_PREFIX %}

{% block content %}
    {% url "home" as home_url %}
    {% url "account_signup" as signup %}
    {% url "pages:contact" as contact %}
    
    <div id="page-wrapper">
        <section class="ps-home-banner ps-home-banner--1">
            <div class="container px-0">
                <div class="ps-section__left">
                    <ul class="menu--dropdown">
                        {% full_tree_for_model category.Category as category %}

                        {% recursetree category %}
                        <li {% if not node.is_leaf_instance %} class="menu-item-has-children has-mega-menu" {% endif %}>
                            <a href="{{ node.get_absolute_url }}">{{ node.name|safe }}</a>
                        </li>
                        {% endrecursetree category %}
                    </ul>
                </div>

                <div class="ps-section__right">
                    <div class="ps-carousel--dots owl-slider" data-owl-auto="true" data-owl-loop="true" data-owl-speed="5000" data-owl-gap="0" data-owl-nav="false" data-owl-dots="true" data-owl-item="1" data-owl-item-xs="1" data-owl-item-sm="1" data-owl-item-md="1" data-owl-item-lg="1" data-owl-duration="1000" data-owl-mousedrag="on">
                        <div class="ps-banner bg--cover" data-background="{{ STATIC_PREFIX }}img/bg/vendor_slider.jpg"><a href="#" class="ps-banner__overlay"></a></div>

                        <div class="ps-banner bg--cover" data-background="{{ STATIC_PREFIX }}img/bg/vendor_slider_1.jpg"><a href="#" class="ps-banner__overlay"></a></div>

                        <div class="ps-banner bg--cover" data-background="{{ STATIC_PREFIX }}img/bg/vendor_slider_2.jpg"><a href="#" class="ps-banner__overlay"></a></div>
                    </div>
                </div>
            </div>
        </section>

        {% if supermaket.exists %}
        
        {% url "catalogue:product_list" as product_list_url %}

        <section class="ps-deal-of-day pb-3">
            <div class="container bg-white py-3">
                <div class="ps-section__header mb-2">
                    <h3 class="text-muted font-weight-bold">Électromenagers &amp; électroniques</h3>
                    <a href="{{ product_list_url }}">Voir plus</a>
                </div>

                <div class="ps-section__content pt-4">
                    <div class="ps-carousel--nav owl-slider" data-owl-auto="true" data-owl-loop="true" data-owl-speed="5000" data-owl-gap="30" data-owl-nav="true" data-owl-dots="true" data-owl-item="5" data-owl-item-xs="2" data-owl-item-sm="3" data-owl-item-md="4" data-owl-item-lg="4" data-owl-item-xl="5" data-owl-duration="1000" data-owl-mousedrag="on">
                        {% for instance in supermaket|shuffle|slice:'0:12' %}
                        {% include "catalogue/snippet/_snippet_product.html" with instance=instance %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </section>
        {% endif %}

        <section class="ps-home-ads pb-3">
            <div class="container px-0">
                <div class="row">
                    <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 ">
                        <a class="ps-collection" href="#">
                            <img src="{{ STATIC_PREFIX }}img/bg/promotion-1.jpg" alt="">
                        </a>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 ">
                        <a class="ps-collection" href="#">
                            <img src="{{ STATIC_PREFIX }}img/bg/promotion-2.jpg" alt="">
                        </a>
                    </div>
                </div>
            </div>
        </section>

        {% if vendor_list %}
            <div class="ps-deal-of-day pb-4">
                <div class="container bg-white py-5">
                    <div class="ps-section__header mb-2">
                        <h3 class="text-muted font-weight-bold">Ils nous ont réjoins</h3>
                        <a href="{{ market.get_absolute_url }}">Voir plus</a>
                    </div>
                    <div class="ps-section__content">
                        <div class="ps-carousel--nav owl-slider" data-owl-auto="true" data-owl-loop="true" data-owl-speed="10000" data-owl-gap="30" data-owl-nav="true" data-owl-dots="true" data-owl-item="5" data-owl-item-xs="2" data-owl-item-sm="3" data-owl-item-md="4" data-owl-item-lg="4" data-owl-item-xl="5" data-owl-duration="1000" data-owl-mousedrag="on">
                            {% for vendor in vendor_list %}
                                <div class="ps-block--category-room border">
                                    <div class="ps-block__thumbnail">
                                        <a href="{{ vendor.get_absolute_url }}">
                                            <img src="{{ STATIC_PREFIX }}img/empty_image.svg" alt="{{ vendor.store }}">
                                        </a>
                                    </div>
                                    <div class="ps-block__content">
                                        <a class="font-weight-bold" href="{{ vendor.get_absolute_url }}">{{ vendor.store }}</a>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}

        <!-- product recently viewed -->
        {% if recently_viewed %}
        <section class="ps-deal-of-day pb-3">
            <div class="container bg-white py-5">
                <div class="ps-section__header mb-2">
                    <h3 class="text-muted font-weight-bold">Produits récemment vus</h3>
                </div>

                <div class="ps-section__content">
                    <div class="ps-carousel--nav owl-slider" data-owl-auto="true" data-owl-loop="true" data-owl-speed="5000" data-owl-gap="30" data-owl-nav="true" data-owl-dots="true" data-owl-item="5" data-owl-item-xs="2" data-owl-item-sm="3" data-owl-item-md="4" data-owl-item-lg="4" data-owl-item-xl="5" data-owl-duration="1000" data-owl-mousedrag="on">
                        {% for instance in recently_viewed|slice:'0:25' %}
                        {% include "catalogue/snippet/_snippet_product.html" with instance=instance %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </section>
        {% endif %}

        <!-- user testimonial -->
        {% testimonial_list 5 %}
    </div>
{% endblock content %}
